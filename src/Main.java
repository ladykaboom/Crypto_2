import java.math.BigInteger;
import java.util.ArrayList;
import java.util.List;

import org.apache.commons.codec.DecoderException;
import org.apache.commons.codec.binary.Hex;
import org.paukov.combinatorics.Factory;
import org.paukov.combinatorics.Generator;
import org.paukov.combinatorics.ICombinatoricsVector;


public class Main {
	public static void main(String[] args) throws DecoderException{
		
	  	//String cryptogram = "10001100 11001111 00010011 10011111 10100010 11101101 01001011 01101101 11110011 11100011 10100000 00100101 10011001 01110111 01101110 11000010 10011101 01001001 10011010 10000010 11000101 11010101 00011000 11011001 10101111 10010011 11001000 01100101 01101110 11101100 11010111 01000100 00010011 11110111 00101011 10101110 00111011 10001010 00111100 11010110 00011000 00101000 10000010 01011000 00111111 11110011 11001111 11111110 11100100 01010101 01001110 01010111 11001001 01111011 11101011 01101000 00000100 00000001 01011000 00100110 00011001 00011101 11010100 01101101 00111100 11001001 10000101 11000001 11100100 01111000 10101010 11000000 11100000 11101001 01010110 00100110 10010101 01011011 11111010 10000101 11001001 10110001 10011110 01010110 00100000 11100010 00111101 00101010 10111101 11101010 00101010 01101001 00110101 01001000 11000011 10101001 00000100 00011010 00111110 11110000 00011001 01001111 10011010 01000010 00110001 00001010 01100100 11001101 11111001 10101001 11111110 00010000 11111000 11100101 10001010 10110001 01100101 00111010 01000010 10000011 01101001 01011110 01000101 01101110 01010111 11010001 11101011 01010110 11010011 01111100 00111000 11010100 01010101 00111111 11110110 10000000 11100010 10101000 00000101 01100101 00001001 10111101 11110101 00001000 01010110 00111010 11010000 00100110 11001010 10010101 11100111 11000001 10110111 10011111 00101111 00100110 10100000 10011010 00000001 11111111 10001001 10101001 01100111 10011010 01010001 00000000 01110111 00111101 11011000 00000000 11101101 01101101 10101010 00100101 11101111 11011110 10101111 00001110 10111010 00110011 01110000 11110101 10011110 11011111 00010101 01001111 01000001 01101011 10100011 11000001 10001100 01000011 01000101 01110001 01101010 10110001 10011010 01001111 11011011 00000111 10111100 11000111 11000101 00000111 11010000 00011011 11110001 01110010 11010001 10010001 00000001 00111111 01111111 11010011 11011000 01110000 01101101 11101010 01011011 10010000 10010101 01000010 11110000 00110010 01101111 10101110 00111011 10111111 10101010 10011000 00101011 11110010 00101010 10100001 11101111 00100011 01010101 11011110 10000101 01001101 01100111 10100011 11110010 01010010 11110101 10000111 00100101 00001110 10001010 10000111 10100001 01010100 01001101 01110011 10010010 01101001 10010010 11100001 11110001 11000010 01111010 01010001 01110011 11111011 00100011 01110010 11111100 00101111 00111101 01110101 00001111 01111111 01100111 11001011 11010001 ";

		/*
		 * bin to hex
		 */
		List<String> lista_mozliwych_slow = new ArrayList<String>();
		
		String plaintext_hex = "";
		//String bin_temp = "01001010 11000010 00110101 00110100 11100001 10010000 00110000 10000000 01000011 00010010 11110101 01010011 10110000 10010111 01011001 01110110 10100001 11111110 01001000 10100101 01011111 10100111 11100011 11010111 01010100 10010100 01011110 00101111 11110001 00111100 01011001 01000011 01101110 01111000 11000000 10101000 11010101 00011010 01101101 10000101 10100101 11000100 01011111 00000000 10011011 00101011 11010000 00100101 00111100 11001011 10001001 11110000 00101110 01001001 10001101 10011000 10111011 11110000 11110001 00010001 11000010 11111101 10001000 01110111 00001001 10000110 01001101 00011111 10010110 10101110 10110101 10100010 00110000 00100010 00010000 11110110 11111111 ";
		String bin_temp = "11101100 01000111 00100001 11001000 01001001 01100101 10101011 11100101 11011010 00000011 10101101 11110010 00000001 11000001 10010111 10011101 10001000 11110100 01001001 01001001 01010110 11010001 11010101 10011110 11101011 11110010 00011001 01111011 00110101 11001010 00000011 11011100 01101110 01101111 01011011 11000110 01001101 11110001 11010110 00001010 11000101 10001101 10001000 10001100 01101011 01100100 01011010 00100000 10001110 10110000 11110010 01001101 11010001 11011011 01011000 00100010 00100110 11101101 01111010 00011111 11101101 11011011 11011001 00010100 00001110 00010011 01111011 11010101 10010011 10110000 01110000 10110000 00001110 00100111 10001110 01000001 11100001";
		String bin = "";
		
		for( int i =0 ; i< bin_temp.length() - 1 ; i++){
			if(bin_temp.charAt(i)!=' '){
				bin = bin + bin_temp.charAt(i);
			}
		}

		try{
			BigInteger decimal = new BigInteger(bin, 2);
			plaintext_hex = decimal.toString(16);
		}
		catch(NumberFormatException e){}
			
	  	/*
	  	 * 
	  	 */
	  	
	  	ICombinatoricsVector<String> originalVector = Factory.createVector(
			      new String[] { "0","1", "2","3","4","5","6","7","8","9","a","b","c","d","e","f" } );
	      Generator<String> gen = Factory.createPermutationWithRepetitionGenerator(
				originalVector, 8);

	      for (ICombinatoricsVector<String> perm : gen){
	  	  	boolean czy_alfanumeryczne = false;
	  	  	int raz_moze_byc_znak = 1;
	  		//rc4 = null;
	  		String part_hex_key = "31fa3aee";
	  		String gen_key_part = "", hex_key="";
	  			//System.out.println( perm );
	  		for (String string : perm) {
	  			gen_key_part = gen_key_part + string;
	  		}	        	
	  		hex_key = gen_key_part + part_hex_key;
			byte[] key = hex_key.getBytes();

	  	//	byte[] key = Hex.decodeHex(key_check.toCharArray());
	  		
	  		//System.out.println("key = " + hex_key);
	  		if(hex_key == "449bdd83af52c65e"){
	  			break;
	  		}
	  		//for(int i=0; i<key.length; i++)
	  	//	System.out.print(key[i]+" ");
			//System.out.println("\n keycheck = "+key_check);

	  		
	  		//rc4 = new RC4(key);
	  		//String result = rc4.decrypt(cryptogram);
	      //System.out.println(result + "\n");
	  		
		  	RC4 rc4 = new RC4(key);

	  		String cipherText =  plaintext_hex;
			//System.out.println("Encrypted: " + cipherText);
			String decrypted = rc4.decrypt(cipherText);
			//System.out.print("Decrypted: " + decrypted);
			for( int i = 0 ; i < decrypted.length() ; i++){
				int j = (int)decrypted.charAt(i);
				
				if( ((  j >= 65 && j <= 122 ) || (j >= 32 &&  j <= 57))){
					//lista_mozliwych_slow.add(decrypted);
					czy_alfanumeryczne = true;
				}
				else {
					if(raz_moze_byc_znak == 1){raz_moze_byc_znak--;}
					else{
						czy_alfanumeryczne = false;
						break;
					}
					
				}
			}
			if(czy_alfanumeryczne == true )
				lista_mozliwych_slow.add(decrypted);
		    //  System.out.println("Rozmiar listy to: "+lista_mozliwych_slow.size() );
		      

	      }
	      
	      for(int i = 0; i<lista_mozliwych_slow.size(); i++ )
	      {
	    	  System.out.println(lista_mozliwych_slow.get(i));
	      }

	}
}
